# LogScan - Утилита для анализа логов и проверки угроз

## Описание

LogScan - это утилита для автоматического анализа лог-файлов, извлечения подозрительных артефактов (IP-адресов и SHA256 хэшей) и их проверки на наличие угроз через VirusTotal API.

## Возможности

- Автоматическое извлечение IP-адресов и SHA256 хэшей из лог-файлов
- Проверка артефактов через VirusTotal API
- Генерация отчетов в форматах CSV и JSON
- Логирование всех операций
- Mock-режим для тестирования без API ключа

## Установка

1. Клонируйте репозиторий или скопируйте файлы проекта
2. Установите зависимости: bash pip install -r requirements.txt


## Базовый синтаксис CLI
python main.py -log-file ПУТЬ_К_ЛОГУ [-api-key API_КЛЮЧ] [-output ФАЙЛ_ОТЧЕТА] [-format csv|json]

## Примеры
- Анализ с mock-режимом (без API ключа): python main.py -log-file logs/sample.log -output report.csv -format csv
- Анализ с реальным API ключом VirusTotal: python main.py -log-file logs/sample.log -api-key YOUR_API_KEY -output report.json -format json
- Анализ с указанием полного пути для отчета: python main.py -log-file /var/log/server.log -output /home/user/reports/threat_report -format csv

## Аргументы командной строки
Аргумент	Описание	Обязательный:

| Аргумент   | Описание                                                | Обязательный                      |
|------------|---------------------------------------------------------|-----------------------------------|
| -log-file  | Путь к анализируемому лог-файлу                         | Да                                |
| -api-key   | API ключ VirusTotal (если не указан, используется mock) | Нет                               |
| -output    | Путь к файлу отчета (без расширения)                    | Нет (по умолчанию: threat_report) |
| -format    | Формат отчета: csv или json                             | Нет (по умолчанию: csv)           |
| -h, --help | Показать справку                                        | Нет                               |

## Форматы отчетов
Содержит следующие колонки:

    value - значение артефакта

    type - тип (IP или HASH)

    check_date - дата проверки

    is_threat - является ли угрозой (True/False)

    threat_level - уровень угрозы (NONE, LOW, MEDIUM, HIGH, CRITICAL)

    malicious_count - количество антивирусов, определивших как вредоносный

    suspicious_count - количество антивирусов, определивших как подозрительный

    details - детальная информация в JSON формате


## JSON отчет

Содержит:

    generated_at - время генерации отчета

    total_artifacts - общее количество проверенных артефактов

    threats_found - количество найденных угроз

    artifacts - массив с детальной информацией по каждому артефакту

## Веб-интерфейс (Flask)
LogScan также включает минимальный веб-интерфейс на основе Flask.

### Запуск веб-интерфейса
python web_app.py\
Откройте браузер и перейдите по адресу: http://localhost:5000

## Возможности веб-интерфейса

- Загрузка лог-файлов через браузер

- Быстрая проверка текста лога без загрузки файла

- Просмотр результатов в удобном табличном формате

- Скачивание отчетов в форматах JSON/CSV

- История отчетов - просмотр последних анализов

- auAPI для интеграции - REST API для автоматизации

## API endpoints

- POST /api/analyze - Анализ загруженного файла

- POST /quick-scan - Быстрая проверка текста лога

- GET /download/<filename> - Скачивание отчета

- GET /recent-reports - Список последних отчетов